\doxysection{D\+:/\+Projects/\+Raspberrypi\+\_\+pico/pico\+\_\+freertos\+\_\+final/freertos\+\_\+pico2/pico\+\_\+freertos/\+Free\+RTOS-\/\+Kernel/portable/\+Third\+Party/\+GCC/\+ATmega/port.c File Reference}
\hypertarget{_third_party_2_g_c_c_2_a_tmega_2port_8c}{}\label{_third_party_2_g_c_c_2_a_tmega_2port_8c}\index{D:/Projects/Raspberrypi\_pico/pico\_freertos\_final/freertos\_pico2/pico\_freertos/FreeRTOS-\/Kernel/portable/ThirdParty/GCC/ATmega/port.c@{D:/Projects/Raspberrypi\_pico/pico\_freertos\_final/freertos\_pico2/pico\_freertos/FreeRTOS-\/Kernel/portable/ThirdParty/GCC/ATmega/port.c}}
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$avr/io.\+h$>$}\newline
{\ttfamily \#include $<$avr/interrupt.\+h$>$}\newline
{\ttfamily \#include $<$avr/wdt.\+h$>$}\newline
{\ttfamily \#include "{}Free\+RTOS.\+h"{}}\newline
{\ttfamily \#include "{}task.\+h"{}}\newline
Include dependency graph for port.\+c\+:
% FIG 0
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_ad05c7a8ee45c5190627f9a49c95e7538}{port\+FLAGS\+\_\+\+INT\+\_\+\+ENABLED}}~( ( \mbox{\hyperlink{_a_r_mv8_m_2non__secure_2portmacrocommon_8h_a84e9a8ba132feed0b2401c1f4e2ac63c}{Stack\+Type\+\_\+t}} ) 0x80 )
\item 
\#define \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_a798f37b250502b49763c54a56b3aa4b0}{port\+SAVE\+\_\+\+CONTEXT}}()
\item 
\#define \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_a8d3a167375b5b57944a57df23d45b39e}{port\+RESTORE\+\_\+\+CONTEXT}}()
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{_a_r_mv8_m_2non__secure_2portmacrocommon_8h_a84e9a8ba132feed0b2401c1f4e2ac63c}{Stack\+Type\+\_\+t}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_aec89de59377079f7dc6a71dfbefd9a6f}{px\+Port\+Initialise\+Stack}} (\mbox{\hyperlink{_a_r_mv8_m_2non__secure_2portmacrocommon_8h_a84e9a8ba132feed0b2401c1f4e2ac63c}{Stack\+Type\+\_\+t}} \texorpdfstring{$\ast$}{*}px\+Top\+Of\+Stack, \mbox{\hyperlink{projdefs_8h_a0ab243e55144f5278d263729530dac14}{Task\+Function\+\_\+t}} px\+Code, void \texorpdfstring{$\ast$}{*}pv\+Parameters)
\item 
\mbox{\hyperlink{_a_r_mv8_m_2non__secure_2portmacrocommon_8h_a46fb21e00ae0729d7515c0fbf2269796}{Base\+Type\+\_\+t}} \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_ade5a8c6666e7413a0355cc252029c5c6}{x\+Port\+Start\+Scheduler}} (void)
\begin{DoxyCompactList}\small\item\em start the freertos scheduler, go to the first task \end{DoxyCompactList}\item 
void \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_af76f3c0b44c5b5c06fc046a4ee1a6423}{v\+Port\+End\+Scheduler}} (void)
\begin{DoxyCompactList}\small\item\em End the Free\+RTOS scheduler. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_add01c927fb689f7ec170e42d47d27927}{v\+Port\+Yield}} (void)
\begin{DoxyCompactList}\small\item\em Yield the CPU. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_afdcc79704f1ce3c8790268b732b7911d}{v\+Port\+Yield\+From\+ISR}} (void)
\item 
void \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_a130213f2e8a8331aaa6dc715f41b6358}{v\+Port\+Yield\+From\+Tick}} (void)
\item 
\mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_a12abd6b38a309cc92d22717bcb3146f5}{ISR}} (port\+SCHEDULER\+\_\+\+ISR)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
volatile \mbox{\hyperlink{_b_c_c_216_bit_d_o_s_2common_2portasm_8h_af5b0f7452857787ed70ce2856ca74c4b}{TCB\+\_\+t}} \texorpdfstring{$\ast$}{*}volatile \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_af7b1fc0a36e224b885fb22b9936a03a2}{px\+Current\+TCB}}
\end{DoxyCompactItemize}


\label{doc-define-members}
\Hypertarget{_third_party_2_g_c_c_2_a_tmega_2port_8c_doc-define-members}
\doxysubsection{Macro Definition Documentation}
\Hypertarget{_third_party_2_g_c_c_2_a_tmega_2port_8c_ad05c7a8ee45c5190627f9a49c95e7538}\index{port.c@{port.c}!portFLAGS\_INT\_ENABLED@{portFLAGS\_INT\_ENABLED}}
\index{portFLAGS\_INT\_ENABLED@{portFLAGS\_INT\_ENABLED}!port.c@{port.c}}
\doxysubsubsection{\texorpdfstring{portFLAGS\_INT\_ENABLED}{portFLAGS\_INT\_ENABLED}}
{\footnotesize\ttfamily \label{_third_party_2_g_c_c_2_a_tmega_2port_8c_ad05c7a8ee45c5190627f9a49c95e7538} 
\#define port\+FLAGS\+\_\+\+INT\+\_\+\+ENABLED~( ( \mbox{\hyperlink{_a_r_mv8_m_2non__secure_2portmacrocommon_8h_a84e9a8ba132feed0b2401c1f4e2ac63c}{Stack\+Type\+\_\+t}} ) 0x80 )}



Definition at line \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_source_l00044}{44}} of file \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_source}{port.\+c}}.

\Hypertarget{_third_party_2_g_c_c_2_a_tmega_2port_8c_a8d3a167375b5b57944a57df23d45b39e}\index{port.c@{port.c}!portRESTORE\_CONTEXT@{portRESTORE\_CONTEXT}}
\index{portRESTORE\_CONTEXT@{portRESTORE\_CONTEXT}!port.c@{port.c}}
\doxysubsubsection{\texorpdfstring{portRESTORE\_CONTEXT}{portRESTORE\_CONTEXT}}
{\footnotesize\ttfamily \label{_third_party_2_g_c_c_2_a_tmega_2port_8c_a8d3a167375b5b57944a57df23d45b39e} 
\#define port\+RESTORE\+\_\+\+CONTEXT(\begin{DoxyParamCaption}\item[{}]{void}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_source_l00476}{476}} of file \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_source}{port.\+c}}.

\Hypertarget{_third_party_2_g_c_c_2_a_tmega_2port_8c_a798f37b250502b49763c54a56b3aa4b0}\index{port.c@{port.c}!portSAVE\_CONTEXT@{portSAVE\_CONTEXT}}
\index{portSAVE\_CONTEXT@{portSAVE\_CONTEXT}!port.c@{port.c}}
\doxysubsubsection{\texorpdfstring{portSAVE\_CONTEXT}{portSAVE\_CONTEXT}}
{\footnotesize\ttfamily \label{_third_party_2_g_c_c_2_a_tmega_2port_8c_a798f37b250502b49763c54a56b3aa4b0} 
\#define port\+SAVE\+\_\+\+CONTEXT(\begin{DoxyParamCaption}\item[{}]{void}{}\end{DoxyParamCaption})}

Enable the watchdog timer, configuring it for expire after (value) timeout (which is a combination of the WDP0 through WDP3 bits).

This function is derived from \texorpdfstring{$<$}{<}avr/wdt.\+h\texorpdfstring{$>$}{>} but enables only the interrupt bit (WDIE), rather than the reset bit (WDE).

Can\textquotesingle{}t find it documented but the WDT, once enabled, rolls over and fires a new interrupt each time.

See also the symbolic constants WDTO\+\_\+15\+MS et al.

Updated to match avr-\/libc 2.\+0.\+0 Enable the watchdog timer, configuring it for expire after (value) timeout (which is a combination of the WDP0 through WDP3 bits).

This function is derived from \texorpdfstring{$<$}{<}avr/wdt.\+h\texorpdfstring{$>$}{>} but enables both the reset bit (WDE), and the interrupt bit (WDIE).

This will ensure that if the interrupt is not serviced before the second timeout, the AVR will reset.

Servicing the interrupt automatically clears it, and ensures the AVR does not reset.

Can\textquotesingle{}t find it documented but the WDT, once enabled, rolls over and fires a new interrupt each time.

See also the symbolic constants WDTO\+\_\+15\+MS et al.

Updated to match avr-\/libc 2.\+0.\+0 

Definition at line \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_source_l00330}{330}} of file \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_source}{port.\+c}}.



\label{doc-func-members}
\Hypertarget{_third_party_2_g_c_c_2_a_tmega_2port_8c_doc-func-members}
\doxysubsection{Function Documentation}
\Hypertarget{_third_party_2_g_c_c_2_a_tmega_2port_8c_a12abd6b38a309cc92d22717bcb3146f5}\index{port.c@{port.c}!ISR@{ISR}}
\index{ISR@{ISR}!port.c@{port.c}}
\doxysubsubsection{\texorpdfstring{ISR()}{ISR()}}
{\footnotesize\ttfamily \label{_third_party_2_g_c_c_2_a_tmega_2port_8c_a12abd6b38a309cc92d22717bcb3146f5} 
ISR (\begin{DoxyParamCaption}\item[{port\+SCHEDULER\+\_\+\+ISR}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_source_l00771}{771}} of file \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_source}{port.\+c}}.

Here is the caller graph for this function\+:
% FIG 1
\Hypertarget{_third_party_2_g_c_c_2_a_tmega_2port_8c_aec89de59377079f7dc6a71dfbefd9a6f}\index{port.c@{port.c}!pxPortInitialiseStack@{pxPortInitialiseStack}}
\index{pxPortInitialiseStack@{pxPortInitialiseStack}!port.c@{port.c}}
\doxysubsubsection{\texorpdfstring{pxPortInitialiseStack()}{pxPortInitialiseStack()}}
{\footnotesize\ttfamily \label{_third_party_2_g_c_c_2_a_tmega_2port_8c_aec89de59377079f7dc6a71dfbefd9a6f} 
\mbox{\hyperlink{_a_r_mv8_m_2non__secure_2portmacrocommon_8h_a84e9a8ba132feed0b2401c1f4e2ac63c}{Stack\+Type\+\_\+t}} \texorpdfstring{$\ast$}{*} px\+Port\+Initialise\+Stack (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{_a_r_mv8_m_2non__secure_2portmacrocommon_8h_a84e9a8ba132feed0b2401c1f4e2ac63c}{Stack\+Type\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{px\+Top\+Of\+Stack}{, }\item[{\mbox{\hyperlink{projdefs_8h_a0ab243e55144f5278d263729530dac14}{Task\+Function\+\_\+t}}}]{px\+Code}{, }\item[{void \texorpdfstring{$\ast$}{*}}]{pv\+Parameters}{}\end{DoxyParamCaption})}

px\+Top\+Of\+Stack = 0x11;

px\+Top\+Of\+Stack = 0x22;

px\+Top\+Of\+Stack = 0x33;

Definition at line \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_source_l00530}{530}} of file \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_source}{port.\+c}}.

\Hypertarget{_third_party_2_g_c_c_2_a_tmega_2port_8c_af76f3c0b44c5b5c06fc046a4ee1a6423}\index{port.c@{port.c}!vPortEndScheduler@{vPortEndScheduler}}
\index{vPortEndScheduler@{vPortEndScheduler}!port.c@{port.c}}
\doxysubsubsection{\texorpdfstring{vPortEndScheduler()}{vPortEndScheduler()}}
{\footnotesize\ttfamily \label{_third_party_2_g_c_c_2_a_tmega_2port_8c_af76f3c0b44c5b5c06fc046a4ee1a6423} 
void v\+Port\+End\+Scheduler (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}



End the Free\+RTOS scheduler. 

Not implemented on this port. 

Definition at line \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_source_l00630}{630}} of file \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_source}{port.\+c}}.

\Hypertarget{_third_party_2_g_c_c_2_a_tmega_2port_8c_add01c927fb689f7ec170e42d47d27927}\index{port.c@{port.c}!vPortYield@{vPortYield}}
\index{vPortYield@{vPortYield}!port.c@{port.c}}
\doxysubsubsection{\texorpdfstring{vPortYield()}{vPortYield()}}
{\footnotesize\ttfamily \label{_third_party_2_g_c_c_2_a_tmega_2port_8c_add01c927fb689f7ec170e42d47d27927} 
void v\+Port\+Yield (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}



Yield the CPU. 



Definition at line \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_source_l00640}{640}} of file \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_source}{port.\+c}}.

Here is the call graph for this function\+:
% FIG 2
\Hypertarget{_third_party_2_g_c_c_2_a_tmega_2port_8c_afdcc79704f1ce3c8790268b732b7911d}\index{port.c@{port.c}!vPortYieldFromISR@{vPortYieldFromISR}}
\index{vPortYieldFromISR@{vPortYieldFromISR}!port.c@{port.c}}
\doxysubsubsection{\texorpdfstring{vPortYieldFromISR()}{vPortYieldFromISR()}}
{\footnotesize\ttfamily \label{_third_party_2_g_c_c_2_a_tmega_2port_8c_afdcc79704f1ce3c8790268b732b7911d} 
void v\+Port\+Yield\+From\+ISR (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_source_l00655}{655}} of file \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_source}{port.\+c}}.

Here is the call graph for this function\+:
% FIG 3
\Hypertarget{_third_party_2_g_c_c_2_a_tmega_2port_8c_a130213f2e8a8331aaa6dc715f41b6358}\index{port.c@{port.c}!vPortYieldFromTick@{vPortYieldFromTick}}
\index{vPortYieldFromTick@{vPortYieldFromTick}!port.c@{port.c}}
\doxysubsubsection{\texorpdfstring{vPortYieldFromTick()}{vPortYieldFromTick()}}
{\footnotesize\ttfamily \label{_third_party_2_g_c_c_2_a_tmega_2port_8c_a130213f2e8a8331aaa6dc715f41b6358} 
void v\+Port\+Yield\+From\+Tick (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_source_l00672}{672}} of file \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_source}{port.\+c}}.

\Hypertarget{_third_party_2_g_c_c_2_a_tmega_2port_8c_ade5a8c6666e7413a0355cc252029c5c6}\index{port.c@{port.c}!xPortStartScheduler@{xPortStartScheduler}}
\index{xPortStartScheduler@{xPortStartScheduler}!port.c@{port.c}}
\doxysubsubsection{\texorpdfstring{xPortStartScheduler()}{xPortStartScheduler()}}
{\footnotesize\ttfamily \label{_third_party_2_g_c_c_2_a_tmega_2port_8c_ade5a8c6666e7413a0355cc252029c5c6} 
\mbox{\hyperlink{_a_r_mv8_m_2non__secure_2portmacrocommon_8h_a46fb21e00ae0729d7515c0fbf2269796}{Base\+Type\+\_\+t}} x\+Port\+Start\+Scheduler (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}



start the freertos scheduler, go to the first task 

\begin{DoxyReturn}{Returns}

\end{DoxyReturn}


Definition at line \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_source_l00613}{613}} of file \mbox{\hyperlink{_third_party_2_g_c_c_2_a_tmega_2port_8c_source}{port.\+c}}.

Here is the call graph for this function\+:
% FIG 4


\label{doc-var-members}
\Hypertarget{_third_party_2_g_c_c_2_a_tmega_2port_8c_doc-var-members}
\doxysubsection{Variable Documentation}
\Hypertarget{_third_party_2_g_c_c_2_a_tmega_2port_8c_af7b1fc0a36e224b885fb22b9936a03a2}\index{port.c@{port.c}!pxCurrentTCB@{pxCurrentTCB}}
\index{pxCurrentTCB@{pxCurrentTCB}!port.c@{port.c}}
\doxysubsubsection{\texorpdfstring{pxCurrentTCB}{pxCurrentTCB}}
{\footnotesize\ttfamily \label{_third_party_2_g_c_c_2_a_tmega_2port_8c_af7b1fc0a36e224b885fb22b9936a03a2} 
volatile \mbox{\hyperlink{_b_c_c_216_bit_d_o_s_2common_2portasm_8h_af5b0f7452857787ed70ce2856ca74c4b}{TCB\+\_\+t}}\texorpdfstring{$\ast$}{*} volatile px\+Current\+TCB\hspace{0.3cm}{\ttfamily [extern]}}



Definition at line \mbox{\hyperlink{_i_a_r_278_k0_r_2_i_s_r___support_8h_source_l00067}{67}} of file \mbox{\hyperlink{_i_a_r_278_k0_r_2_i_s_r___support_8h_source}{ISR\+\_\+\+Support.\+h}}.

